name: Build ExcelToWord_Practice (.NET Framework 4.8 Project)

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]
  workflow_dispatch:

jobs:
  build:
    runs-on: windows-latest

    steps:
      - name: 取得程式碼
        uses: actions/checkout@v4

      - name: 顯示目前路徑與檔案（方便除錯）
        run: |
          echo "目前工作目錄："
          cd
          echo "檔案列表："
          dir /b /s

      - name: 設定 MSBuild
        uses: microsoft/setup-msbuild@v2

      - name: 還原 NuGet 套件
        run: nuget restore ExcelToWord_Practice.sln
        working-directory: ${{ github.workspace }}\..

      - name: 建置 Solution
        run: msbuild ExcelToWord_Practice.sln /p:Configuration=Release
        working-directory: ${{ github.workspace }}\..

      - name: 上傳編譯成果
        uses: actions/upload-artifact@v4
        with:
          name: ExcelToWord_Build_Output
          path: '**/bin/Release/'
