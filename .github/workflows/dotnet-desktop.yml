name: Build ExcelToWord_Practice (.NET Framework 4.8 Project)

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]
  workflow_dispatch:

jobs:
  build:
    runs-on: windows-latest

    steps:
      - name: å–å¾—ç¨‹å¼ç¢¼
        uses: actions/checkout@v4

      # ğŸ‘‡ é¡¯ç¤ºå¯¦éš›è³‡æ–™å¤¾å±¤ç´šï¼Œç¢ºèª .sln çš„æ‰€åœ¨
      - name: é¡¯ç¤ºå®Œæ•´è·¯å¾‘èˆ‡æª”æ¡ˆåˆ—è¡¨
        run: |
          echo "=== ç›®å‰ç›®éŒ„ ==="
          cd
          echo "=== ä¸Šä¸€å±¤ ==="
          cd ..
          dir /b
          echo "=== å†ä¸Šä¸€å±¤ ==="
          cd ..
          dir /b
          echo "=== å…¨éƒ¨æª”æ¡ˆï¼ˆéè¿´ï¼‰ ==="
          cd ${{ github.workspace }}
          dir /s /b | findstr .sln

      - name: è¨­å®š MSBuild
        uses: microsoft/setup-msbuild@v2

      # ğŸ‘‡ ç”¨ PowerShell è‡ªå‹•å°‹æ‰¾ .sln æª”æ¡ˆå†é‚„åŸ
      - name: è‡ªå‹•å°‹æ‰¾ä¸¦é‚„åŸ NuGet å¥—ä»¶
        shell: pwsh
        run: |
          $sln = Get-ChildItem -Path $env:GITHUB_WORKSPACE -Recurse -Filter "*.sln" | Select-Object -First 1
          if ($null -eq $sln) {
            Write-Error "âŒ æ‰¾ä¸åˆ° .sln æª”æ¡ˆ"
            exit 1
          } else {
            Write-Host "âœ… æ‰¾åˆ°è§£æ±ºæ–¹æ¡ˆæª”æ¡ˆï¼š" $sln.FullName
            nuget restore $sln.FullName
          }

      - name: å»ºç½® Solution
        shell: pwsh
        run: |
          $sln = Get-ChildItem -Path $env:GITHUB_WORKSPACE -Recurse -Filter "*.sln" | Select-Object -First 1
          Write-Host "ğŸ”§ é–‹å§‹å»ºç½®ï¼š" $sln.FullName
          msbuild $sln.FullName /p:Configuration=Release

      - name: ä¸Šå‚³ç·¨è­¯æˆæœ
        uses: actions/upload-artifact@v4
        with:
          name: ExcelToWord_Build_Output
          path: '**/bin/Release/'
