name: Build ExcelToWord_Practice (.NET Framework 4.8 Project)
on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]
  workflow_dispatch:

jobs:
  build:
    runs-on: windows-latest
    steps:
      - name: 取得程式碼
        uses: actions/checkout@v4
      
      - name: 顯示檔案結構(除錯用)
        run: |
          echo "=== 根目錄檔案 ==="
          dir
          echo "=== 搜尋所有 .sln 檔案 ==="
          dir /s /b *.sln
      
      - name: 設定 MSBuild
        uses: microsoft/setup-msbuild@v2
      
      # 方法1: 直接指定路徑還原 NuGet
      - name: 還原 NuGet 套件
        run: nuget restore ExcelToWord_Practice/ExcelToWord_Practice.sln
      
      # 方法1: 直接指定路徑建置
      - name: 建置 Solution
        run: msbuild ExcelToWord_Practice/ExcelToWord_Practice.sln /p:Configuration=Release /p:Platform="Any CPU"
      
      - name: 上傳編譯成果
        uses: actions/upload-artifact@v4
        with:
          name: ExcelToWord_Build_Output
          path: 'ExcelToWord_Practice/**/bin/Release/'
