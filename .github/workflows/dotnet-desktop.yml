name: Build .NET Framework 4.8 Project

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

jobs:
  build:
    runs-on: windows-latest

    steps:
      - name: 取得程式碼
        uses: actions/checkout@v4

      # 加入 MSBuild 到 PATH（GitHub 已預裝 Visual Studio）
      - name: 設定 MSBuild
        uses: microsoft/setup-msbuild@v2

      # 還原 NuGet 套件
      - name: 還原 NuGet 套件
        run: nuget restore ExcelToWord.sln

      # 建置 .NET Framework 專案
      - name: 建置 Solution
        run: msbuild ExcelToWord.sln /p:Configuration=Release

      # 上傳 Build 結果（可選）
      - name: 上傳編譯成果
        uses: actions/upload-artifact@v4
        with:
          name: ExcelToWord-Build
          path: '**/bin/Release/'
